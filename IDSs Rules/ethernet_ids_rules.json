{
  "version": "1.0",
  "protocol": "robot_udp",
  "description": "Unified Ethernet IDS Rules for Vehicle Networks (Corrected)",
  "total_rules": 10,
  "rules": [
    {
      "rule_id": "robot_protocol_validation",
      "rule_type": "protocol_validation",
      "protocol": "robot_udp",
      "description": "Validate robot UDP protocol structure",
      "parameters": {
        "port": 6699,
        "magic_bytes": "55aa5aa5",
        "magic_offset": 44,
        "packet_size_range": [
          1210,
          1210
        ]
      },
      "severity": "critical",
      "enabled": true
    },
    {
      "rule_id": "robot_ip_whitelist",
      "rule_type": "ip_validation",
      "protocol": "robot_udp",
      "description": "Validate source and destination IPs",
      "parameters": {
        "allowed_ips": [
          "224.0.0.251",
          "224.0.1.129",
          "224.0.0.107",
          "192.168.1.200",
          "192.168.1.102"
        ],
        "subnet": "192.168.1.0/24",
        "alert_unknown": true
      },
      "severity": "high",
      "enabled": true
    },
    {
      "rule_id": "robot_message_type_validation",
      "rule_type": "message_validation",
      "protocol": "robot_udp",
      "description": "Validate message type IDs",
      "parameters": {
        "valid_range": [
          1,
          630
        ],
        "cycle_length": 630,
        "detect_out_of_range": true,
        "track_distribution": true
      },
      "severity": "high",
      "enabled": true
    },
    {
      "rule_id": "robot_sequence_validation",
      "rule_type": "sequence_check",
      "protocol": "robot_udp",
      "description": "Validate message sequence numbers",
      "parameters": {
        "max_gap": 20,
        "detect_replay": true,
        "detect_out_of_order": true,
        "window_size": 100
      },
      "severity": "high",
      "enabled": true
    },
    {
      "rule_id": "robot_frequency_monitor",
      "rule_type": "frequency_analysis",
      "protocol": "robot_udp",
      "description": "Monitor message frequency (Corrected thresholds)",
      "parameters": {
        "baseline_rate": 10.0,
        "min_rate": 5.0,
        "max_rate": 20.0,
        "window_size_ms": 1000,
        "hysteresis_count": 5,
        "alert_cooldown": 30.0
      },
      "severity": "medium",
      "enabled": true
    },
    {
      "rule_id": "robot_dos_detection",
      "rule_type": "dos_detection",
      "protocol": "robot_udp",
      "description": "Detect denial of service attacks",
      "parameters": {
        "burst_threshold": 100,
        "sustained_threshold": 12591.025460592988,
        "time_window_ms": 1000
      },
      "severity": "critical",
      "enabled": true
    },
    {
      "rule_id": "robot_replay_detection",
      "rule_type": "replay_check",
      "protocol": "robot_udp",
      "description": "Detect replay attacks",
      "parameters": {
        "hash_window": 10000,
        "time_window_seconds": 60,
        "check_partial": true
      },
      "severity": "critical",
      "enabled": true
    },
    {
      "rule_id": "robot_fuzzing_detection",
      "rule_type": "fuzzing_check",
      "protocol": "robot_udp",
      "description": "Detect fuzzing attempts",
      "parameters": {
        "entropy_threshold": 7.0,
        "pattern_check": true,
        "sample_size": 100
      },
      "severity": "high",
      "enabled": true
    },
    {
      "rule_id": "robot_injection_detection",
      "rule_type": "injection_check",
      "protocol": "robot_udp",
      "description": "Detect message injection (Corrected thresholds)",
      "parameters": {
        "timing_analysis": true,
        "sequence_analysis": true,
        "source_validation": true,
        "deviation_threshold": 2.0,
        "hysteresis_count": 5,
        "alert_cooldown": 10.0
      },
      "severity": "critical",
      "enabled": true
    },
    {
      "rule_id": "robot_pattern_anomaly",
      "rule_type": "anomaly_detection",
      "protocol": "robot_udp",
      "description": "Detect communication pattern anomalies",
      "parameters": {
        "baseline_window": 1000,
        "deviation_threshold": 3.0,
        "ml_enabled": false
      },
      "severity": "medium",
      "enabled": true
    }
  ]
}